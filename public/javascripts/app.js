import{deleteCookie as d,findUser as f,getCookie as g,getDateTime as h,getFromLocalStorage as i,insertTextContent as j,searchTodo as k}from"./modules/utils.js";import{hideCalendar as l,showCalendar as m}from"./modules/calendar.js";import{hideNotifications as n,showNotifications as o}from"./modules/notification.js";import{hideOverlay as p,hideTodoOptions as q,hideTransparentOverlay as r,showOverlay as s,showTransparentOverlay as t}from"./modules/shared.js";import{hideTodoModal as u}from"./modules/todo-modal.js";let v={},w={},x=window.innerWidth>=600;function y(){z();const a=document.getElementById("sidebar");a.classList.remove("-left-50");a.classList.add("left-0");t()}function A(){const a=document.getElementById("sidebar");a.classList.add("-left-50");a.classList.remove("left-0");r()}function B(){x?A():y();x=!x}const C=document.getElementById("toggle-menu");C.addEventListener("click",B);function D(){z();s();const a=document.getElementById("mobile-search-bar");a.classList.remove("hidden")}function E(){p();const a=document.getElementById("mobile-search-bar");a.classList.add("hidden")}function z(){A();E();n();l();u();q()}const F=document.getElementById("overlay");F.addEventListener("click",z);const G=document.getElementById("search-bar-icon");G.addEventListener("click",D);const H=document.getElementById("search-result-container"),I=document.getElementById("mobile-search-result");function J(a,b){if(null==b)return;let c="";a.length?a.forEach(a=>{const{id:b,priority:d,cover:e,title:f}=a;c+=`<li class="px-3.75 py-1.5 lg:py-2.5"><a class="flex items-center justify-between gap-x-4 cursor-pointer" href="/public/pages/todo-details.html?id=${b}"><div><p class="text-sm lg:text-base/relaxed line-clamp-2">${f}</p><span class="font-medium text-xs">Priority: </span><span class="font-medium text-xs ${"high"===d.toLowerCase()?"text-danger":"medium"===d.toLowerCase()?"text-amber-400":"text-picton-blue"}">${d}</span></div><div class="size-10 lg:size-13 shrink-0 rounded-sm overflow-hidden">${e.img?`<img class="aspect-square" src="${e.img}" alt="${e.alt}" />`:`<img class="aspect-square" src="/public/assets/images/todoes/${e.path}" alt="${e.alt}" />`}</div></a></li>`}):c='<li class="px-3.75 py-1.5 lg:py-2.5"> <span class="text-quick-silver">Try something different</span></li>';b.innerHTML=c}function K(a){const b=a.target.value.trim();if(b.length>2){const a=i("DB").users,c=g("userId");w=f(c,a);const d=k(b,w.todos);J(d,H);J(d,I)}else{const a='<li class="px-3.75 py-1.5 lg:py-2.5"><span class="text-quick-silver">You must type at least 3 characters</span></li>';H.innerHTML=a;I.innerHTML=a}}const L=document.getElementById("header-search-input");L.addEventListener("keyup",K);const M=document.getElementById("mobile-search-input");M.addEventListener("keyup",K);function N(){const a=document.getElementById("today-date"),b=h();a.innerHTML=`<span>${b.weekdayName}</span><span class="text-picton-blue">${b.date}</span>`}function O(){null==g("userId")&&(location.href="/public/pages/login.html")}window.addEventListener("load",async()=>{O();N();const a=g("userId");v=i("DB");w=f(a,v.users);j(`${w.name} ${w.family}`,"user-full-name");j(w.email,"user-email")});document.getElementById("notification-show-btn").addEventListener("click",()=>{z();o()});document.getElementById("notification__hide-btn").addEventListener("click",n);document.getElementById("calendar-show-btn").addEventListener("click",()=>{z();m()});document.getElementById("transparent-overlay").addEventListener("click",z);const P=document.getElementsByClassName("logout-btn")[0];P.addEventListener("click",async a=>{a.preventDefault();const b=await swal({title:"Are you sure want to logout?",icon:"warning",buttons:{no:{text:"Cancel",value:!1,className:"swal-btn--natural"},yes:{text:"Yes, logout!",value:!0,className:"swal-btn--danger"}}});b&&(d("userId","/public"),location.href="/public/pages/login.html")});