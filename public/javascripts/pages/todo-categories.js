import{hideLoader as a,showOverlay as b,hideOverlay as c}from"../modules/shared.js";import{escapeHtml as d,getFromLocalStorage as e,saveToLocalStorage as f}from"../modules/utils.js";let g={},h=[];const i=document.getElementById("categories-container");function j(k,l){let m="";k.length?k.forEach((n,o)=>{m+=`<div class="flex items-center justify-between"><h4 class="font-semibold">Todo ${n.name} <span class="block h-0.5 w-10 bg-orioles-orange"></span></h4><button class="my-auto flex items-center gap-x-2 text-xs text-quick-silver cursor-pointer hover:text-primary transition-all duration-200 hover:*:fill-white hover:*:bg-primary" onclick="showModal('${n.name}')"><svg class="fill-primary p-px size-[15px] transition-all duration-200 rounded-full"><use href="#plus-icon"></use></svg>Add New ${n.name}</button></div><div class="overflow-x-auto w-[calc(100%+8px)] -ml-1 px-1 pb-8">${p(n)}</div>${k.length!==o+1?`<div class="w-[calc(100%+56px)] xs:w-[calc(100%+48px)] md:w-[calc(100%+56px)] -ml-6 md:-ml-7 border-t mb-7.5 border-quick-silver/63"></div>`:""}`}):m="<span>No Category available</span>",l.innerHTML=m}function p(q){return`<table class="text-sm md:text-base text-center border-separate border-spacing-0 border border-quick-silver/63 rounded-[14px] w-full mt-3.5 shadow-todo"><thead><tr class="border-quick-silver/63"><th class="px-2.5 py-4 border-b border-quick-silver/63">SN</th><th class="text-nowrap w-1/2 xl:w-52/100 px-2.5 py-4 border-b border-x border-quick-silver/63">Todo ${q.name}</th><th class="px-2.5 w-42/100 xl:w-40/100 py-4 border-b border-quick-silver/63">Action</th></tr></thead><tbody id="todo-status-tbody" class="*:*:*:mb-3.5 *:*:*:px-2.5 *:first:*:*:mt-4.5 *:last:*:*:mb-4.5">${r(q)}</tbody></table>`}function r(s){let t="";return s.values.length?s.values.forEach((u,v)=>{t+=`<tr><td><span class="block">${v+1}</span></td><td class="border-x border-quick-silver/63"><span class="capitalize line-clamp-1" title="${u}">${u}</span></td><td class="flex justify-center gap-x-3 md:gap-x-4 lg:gap-x-5 xl:gap-x-7.5 px-2.5"><button class="flex items-center gap-x-1 text-white bg-orioles-orange py-1 md:py-1.5 px-3 md:px-3.5 xl:px-4.5 rounded-lg cursor-pointer" onclick="showModal('${s.name}','${u}')"><svg class="size-4 lg:size-4.75"><use href="#edit-icon"></use></svg>Edit</button><button class="flex items-center gap-x-1 text-white bg-orioles-orange py-1 md:py-1.5 px-3 md:px-3.5 xl:px-4.5 rounded-lg cursor-pointer" onclick="deleteCategoryValue('${s.name}','${u}')"><svg class="size-4 lg:size-4.75"><use href="#delete-icon"></use></svg>Delete</button></td></tr>`}):t=`<tr><td></td><td class="w-full"><span class="block text-davy-grey">No category value available</span></td><td></td></tr>`,t}window.deleteCategoryValue=w;async function w(x,y){const z=await swal({title:"Delete category value",text:"are you sure to delete category value?",icon:"warning",buttons:["Cancel","Delete"]});if(!z)return;const A=B(x);h[A].values=h[A].values.filter(C=>C!==y),g.categories=h,f("DB",g),j(h,i)}function B(D){return h.findIndex(E=>E.name===D)}window.addEventListener("load",()=>{g=e("DB"),h=g.categories,j(h,i),a()});function F(G,H){const I=document.getElementById("category-modal__title"),J=document.getElementById("category-form__input-label"),K=document.getElementById("category-form__input");I.textContent=`Add Todo ${G}`,J.textContent=`Todo ${G} title`,K.value=H??"",K.dataset.category=G,K.dataset.currentValue=H??""}window.showModal=L;function L(M,N){F(M,N),b(),document.getElementById("category-modal").classList.remove("hidden")}function O(){c(),document.getElementById("category-modal").classList.add("hidden")}const P=document.getElementById("category-modal__close-btn");P.addEventListener("click",O);const Q=document.getElementById("overlay");Q.addEventListener("click",O);function R(S){S.preventDefault();const T=document.getElementById("category-form__input"),U=T.dataset.category,V=T.dataset.currentValue,W=T.value.trim().toLowerCase(),X=B(U),Y=h[X].values.findIndex(Z=>Z===V);W?Y!==-1?h[X].values[Y]=d(W):h[X].values.push(d(W)):swal({title:"Please enter valid value",icon:"warning"}),Y!==-1||W?(g.categories=h,f("DB",g),j(h,i)):null,O()}const aa=document.getElementById("category-modal__save-btn");aa.addEventListener("click",R);