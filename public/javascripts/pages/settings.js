import{hideLoader as a,showLoader as b}from"../modules/shared.js";import{findUser as c,getCookie as d,getFromLocalStorage as e,saveToLocalStorage as f}from"../modules/utils.js";let g={};function h(i){const j=document.getElementById("first-name-input"),k=document.getElementById("last-name-input"),l=document.getElementById("email-input");j.value=i.name,k.value=i.family,l.value=i.email}function m(n){const o=g.password===n;return o||swal({title:"Your password is wrong",icon:"error"}),o}function p({name:q,family:r,email:s,newPassword:t}){const u={name:/^[a-zA-Z]{3,16}$/,email:/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/,password:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)*(?=.*[@\(!\)%*?&])[a-zA-Z\d@\(!\)%*?&]{8,24}$/},v=q&&r&&s&&t;return t?v?u.name.test(q)?u.name.test(r)?u.email.test(s)?u.password.test(t)||!swal({title:"please enter valid password",text:"at least 8 charactor, contain lower case, upper case, number, special charactor",icon:"warning"}):(swal({title:"Please enter valid email",icon:"warning"}),!1):(swal({title:"Please enter valid last name",text:"minimun 3 charactor (number is not valid!!)",icon:"warning"}),!1):(swal({title:"Please enter valid first name",text:"minimun 3 charactor (number is not valid!!)",icon:"warning"}),!1):(swal({title:"Please fill all fields",icon:"warning"}),!1):(swal({title:"Please enter new password",text:"if you don't want to change password enter current password",icon:"warning"}),!1)}function w(){const x=document.getElementById("new-password-input"),y=document.getElementById("first-name-input"),z=document.getElementById("last-name-input"),A=document.getElementById("email-input"),B=document.getElementById("current-password-input");return{...g,name:y.value.trim(),family:z.value.trim(),email:A.value.trim(),password:B.value.trim(),newPassword:x.value.trim()}}function C(D){const E=e("DB"),F=E.users.findIndex(G=>G.id===D.id);F!==-1&&(E.users[F]=D,f("DB",E))}function H(I){I.preventDefault();const J=w();m(J.password)&&p(J)&&(J.password=J.newPassword,delete J.newPassword,g=J,C(g),swal({title:"Your information successfuly updated",icon:"success"}).then(()=>location.reload()))}const K=document.getElementById("save-changes-btn");K.addEventListener("click",H),window.addEventListener("load",()=>{b();const L=d("userId"),M=e("DB");g=c(L,M.users),h(g),a()});