"use strict";import{hideTransparentOverlay as e,showTransparentOverlay as n}from"./shared.js";import{convertMonthToMonthName as a}from"./utils.js";let date=new Date,weekday=date.getDay()+1,currentMonth=date.getMonth()+1,currentDay=date.getDate(),currentYear=date.getFullYear(),numberOfDaysOnMonth=calcNumberOfDaysOnMonth(),fisrtDayOfMonthOnWeek=calcFisrtDayOfMonthOnWeek();function nextMonth(){currentMonth<12?currentMonth++:(currentMonth=1,currentYear++),(fisrtDayOfMonthOnWeek+=numberOfDaysOnMonth%7)>7&&(fisrtDayOfMonthOnWeek%=7),numberOfDaysOnMonth=calcNumberOfDaysOnMonth(),insertDaysOnCalendar(),insertMonthYearOnCalendar(),updateDateOnCalendarInput()}let nextMonthBtn=document.getElementById("next-month-btn");function previousMonth(){currentMonth>1?currentMonth--:(currentMonth=12,currentYear--),(fisrtDayOfMonthOnWeek-=(numberOfDaysOnMonth=calcNumberOfDaysOnMonth())%7)<1&&(fisrtDayOfMonthOnWeek+=7),insertDaysOnCalendar(),insertMonthYearOnCalendar(),updateDateOnCalendarInput()}function calcNumberOfDaysOnMonth(){return[1,3,5,7,8,10,12].includes(currentMonth)?31:[4,6,9,11].includes(currentMonth)?30:currentYear%4==0?29:28}function insertMonthYearOnCalendar(){document.getElementById("calendar__month-year").innerHTML=`
    ${a(currentMonth)} ${currentYear}`}function calcFisrtDayOfMonthOnWeek(){let e=new Date(`${currentYear}-${currentMonth}-1`).getDay();return(e+2)%7}function calcFisrtDayOfMonthOnWeekV1(){let e=weekday,n=-(currentDay%7)+1;n<1&&(n=7-currentDay%7+1);for(let a=0;a<n;a++)e=(e+1)%7;return e}function normalizeDateForInput(){let e=currentYear,n=String(currentMonth).padStart(2,0),a=String(currentDay).padStart(2,0);return`${e}-${n}-${a}`}function updateDateOnCalendarInput(){document.getElementById("calendar__input-date").value=normalizeDateForInput()}function insertDaysOnCalendar(){let e=document.getElementById("calendar__tbody"),n=[],a="",t="";for(let r=1;r<fisrtDayOfMonthOnWeek;r++)n.push("<td></td>");for(let d=1;d<=numberOfDaysOnMonth;d++)n.push(`<td class="${currentDay===d?"calendar__day--active":"calendar__day"}">${d}</td>`);let s=n.length;for(let c=1;c<=s;c++)t+=n[c-1],c%7==0&&(a+=`
        <tr class="grid grid-cols-7 gap-x-2 md:gap-x-5">
          ${t}
        </tr>`,t="");t&&(a+=`
      <tr class="grid grid-cols-7 gap-x-5.5 gap-y-6.5">
        ${t}
      </tr>`),e.innerHTML=a}function insertDaysOnCalendarV1(e){let n=`
  <span class="calendar__weekday-name">MON</span>
  <span class="calendar__weekday-name">TUE</span>
  <span class="calendar__weekday-name">WED</span>
  <span class="calendar__weekday-name">THU</span>
  <span class="calendar__weekday-name">FRI</span>
  <span class="calendar__weekday-name">SAT</span>
  <span class="calendar__weekday-name">SUN</span>
  `;for(let a=1;a<fisrtDayOfMonthOnWeek;a++)n+="<span></span>";for(let t=1;t<=numberOfDaysOnMonth;t++)n+=`
        <span class="${t===currentDay?"calendar__day--active":"calendar__day"}">${t}</span>`;e.innerHTML=n}function updateCalendar(e){let n=e.target.value;currentYear=Number(n.slice(0,4))||2e3,currentMonth=Number(n.slice(5,7))||1,currentDay=Number(n.slice(8,10))||1,fisrtDayOfMonthOnWeek=calcFisrtDayOfMonthOnWeek(),insertDaysOnCalendar(),insertMonthYearOnCalendar()}function showCalendar(){n(),document.getElementById("calendar").classList.remove("opacity-0","invisible")}function hideCalendar(){e(),document.getElementById("calendar").classList.add("opacity-0","invisible")}nextMonthBtn.addEventListener("click",nextMonth),document.getElementById("previous-month-btn").addEventListener("click",previousMonth),window.addEventListener("load",()=>{insertDaysOnCalendar(),insertMonthYearOnCalendar(),updateDateOnCalendarInput()}),document.getElementById("calendar__input-date").addEventListener("change",updateCalendar),document.getElementById("calendar__tbody").addEventListener("click",e=>{"calendar__day"===e.target.className&&(currentDay=Number(e.target.textContent),insertDaysOnCalendar(),updateDateOnCalendarInput())}),document.getElementById("calendar__hide-btn").addEventListener("click",hideCalendar);export{showCalendar,hideCalendar};