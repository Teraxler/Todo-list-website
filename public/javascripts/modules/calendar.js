"use strict";import{hideTransparentOverlay,showTransparentOverlay}from"./shared.js";import{convertMonthToMonthName}from"./utils.js";const date=new Date;let weekday=date.getDay()+1,currentMonth=date.getMonth()+1,currentDay=date.getDate(),currentYear=date.getFullYear(),numberOfDaysOnMonth=calcNumberOfDaysOnMonth(),fisrtDayOfMonthOnWeek=calcFisrtDayOfMonthOnWeek();function nextMonth(){currentMonth<12?currentMonth++:(currentMonth=1,currentYear++),fisrtDayOfMonthOnWeek+=numberOfDaysOnMonth%7,fisrtDayOfMonthOnWeek>7&&(fisrtDayOfMonthOnWeek%=7),numberOfDaysOnMonth=calcNumberOfDaysOnMonth(),insertDaysOnCalendar(),insertMonthYearOnCalendar(),updateDateOnCalendarInput()}const nextMonthBtn=document.getElementById("next-month-btn");function previousMonth(){currentMonth>1?currentMonth--:(currentMonth=12,currentYear--),numberOfDaysOnMonth=calcNumberOfDaysOnMonth(),fisrtDayOfMonthOnWeek-=numberOfDaysOnMonth%7,fisrtDayOfMonthOnWeek<1&&(fisrtDayOfMonthOnWeek+=7),insertDaysOnCalendar(),insertMonthYearOnCalendar(),updateDateOnCalendarInput()}function calcNumberOfDaysOnMonth(){return[1,3,5,7,8,10,12].includes(currentMonth)?31:[4,6,9,11].includes(currentMonth)?30:currentYear%4==0?29:28}function insertMonthYearOnCalendar(){document.getElementById("calendar__month-year").innerHTML=`\n    ${convertMonthToMonthName(currentMonth)} ${currentYear}`}function calcFisrtDayOfMonthOnWeek(){let n=new Date(`${currentYear}-${currentMonth}-1`).getDay();return n=(n+2)%7,n}function calcFisrtDayOfMonthOnWeekV1(){let n=weekday,e=-currentDay%7+1;e<1&&(e=7-currentDay%7+1);for(let t=0;t<e;t++)n=(n+1)%7;return n}function normalizeDateForInput(){return`${currentYear}-${String(currentMonth).padStart(2,0)}-${String(currentDay).padStart(2,0)}`}function updateDateOnCalendarInput(){document.getElementById("calendar__input-date").value=normalizeDateForInput()}function insertDaysOnCalendar(){const n=document.getElementById("calendar__tbody"),e=[];let t="",a="";for(let n=1;n<fisrtDayOfMonthOnWeek;n++)e.push("<td></td>");for(let n=1;n<=numberOfDaysOnMonth;n++)e.push(`<td class="${currentDay===n?"calendar__day--active":"calendar__day"}">${n}</td>`);const r=e.length;for(let n=1;n<=r;n++)a+=e[n-1],n%7==0&&(t+=`\n        <tr class="grid grid-cols-7 gap-x-2 md:gap-x-5">\n          ${a}\n        </tr>`,a="");a&&(t+=`\n      <tr class="grid grid-cols-7 gap-x-5.5 gap-y-6.5">\n        ${a}\n      </tr>`),n.innerHTML=t}function insertDaysOnCalendarV1(n){let e='\n  <span class="calendar__weekday-name">MON</span>\n  <span class="calendar__weekday-name">TUE</span>\n  <span class="calendar__weekday-name">WED</span>\n  <span class="calendar__weekday-name">THU</span>\n  <span class="calendar__weekday-name">FRI</span>\n  <span class="calendar__weekday-name">SAT</span>\n  <span class="calendar__weekday-name">SUN</span>\n  ';for(let n=1;n<fisrtDayOfMonthOnWeek;n++)e+="<span></span>";for(let n=1;n<=numberOfDaysOnMonth;n++)e+=`\n        <span class="${n===currentDay?"calendar__day--active":"calendar__day"}">${n}</span>`;n.innerHTML=e}function updateCalendar(n){const e=n.target.value;currentYear=Number(e.slice(0,4))||2e3,currentMonth=Number(e.slice(5,7))||1,currentDay=Number(e.slice(8,10))||1,fisrtDayOfMonthOnWeek=calcFisrtDayOfMonthOnWeek(),insertDaysOnCalendar(),insertMonthYearOnCalendar()}function showCalendar(){showTransparentOverlay(),document.getElementById("calendar").classList.remove("opacity-0","invisible")}function hideCalendar(){hideTransparentOverlay(),document.getElementById("calendar").classList.add("opacity-0","invisible")}nextMonthBtn.addEventListener("click",nextMonth),document.getElementById("previous-month-btn").addEventListener("click",previousMonth),window.addEventListener("load",(()=>{insertDaysOnCalendar(),insertMonthYearOnCalendar(),updateDateOnCalendarInput()})),document.getElementById("calendar__input-date").addEventListener("change",updateCalendar),document.getElementById("calendar__tbody").addEventListener("click",(n=>{"calendar__day"===n.target.className&&(currentDay=Number(n.target.textContent),insertDaysOnCalendar(),updateDateOnCalendarInput())})),document.getElementById("calendar__hide-btn").addEventListener("click",hideCalendar);export{showCalendar,hideCalendar};